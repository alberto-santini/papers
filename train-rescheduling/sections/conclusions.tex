\section{Conclusions}\label{sec:conclusions}

In this paper we presented a fast algorithm for the conflicts resolution in real-time train traffic management. The development of the algorithm was motivated by an extensive collaboration between the authors and Alstom, and an industrial version of it is currently integrated into the Train Management System ICONIS and will be deployed at various Alstomâ€™s customers worldwide.

The algorithm is designed to combine speed and flexibility through an abstract modelling of the rail infrastructure that can be used both at a microscopic and at a macroscopic (i.e. aggregated) representation of the network, and even a mix of the two. Overall the algorithm is based on the repeated execution of a greedy approach which schedules trains on a time-spaced network and several different dispatching rules. Two different shaking techniques, one based on Reduced Variable Neighborhood Search and the other on Tabu Search, are implemented. The speed required to handle realistic sized instances, involving tens of trains during a time horizons of a few hours, is achieved by implementing different effective sparsification techniques of the time-space graph which greatly reduce the computational effort while preserving good accuracy of the results. In addition, an extensive study of the impact of each algorithm component on the quality and speed of the algorithm was conducted, so as to identify some best performing parameter combinations which can be used inside a simple parallelization scheme.

The algorithm is capable of handling the constraints typically encountered in real-world train rescheduling applications and, thanks to the time-space representation and the greedy nature of its main structure, can be easily adapted to accommodate possible further characteristics. Furthermore, a very general hierarchic objective function allows to optimize different aspects of the problem as the number of possibly remaining conflicts, the average delay and the number of modifications with respect to the nominal timetable.

An extensive computational testing has been performed by using both real-world instances provided by Alstom and artificial instances constructed from existing benchmarks from the literature. The main aim of the testing was to identify the best performing components and parameter configurations and to validate the effectiveness of the algorithm for the real-time conflict resolution. The obtained results show that the proposed algorithms is, within a few seconds, consistently capable of resolving existing conflicts and obtain highly optimized solutions. This is also confirmed by the extensive testing of the industrial version of the algorithm performed by Alstom during the last years where the solutions were consistently found correct and effective by expert users when compared with traditionally employed priority dispatching rules.

Even though some of the components of our algorithm were already known in the literature, we think that the main contribution of our approach is the effective combination of various dispatching rules with shaking, together with the use of sparsification and parallelization to achieve high speed without compromising quality. Clearly the simple structure and the required speed may lead sometimes to difficulty in removing all existing conflicts (or detecting that they are not solvable) or in relatively poor solutions but the computational results show that this is a rare event and that the algorithm provides an excellent compromise between quality and speed.

\section*{Acknowledgements}

The authors are grateful to Alstom Transport for providing the test instances used for the computational validation of our method.
